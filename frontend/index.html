<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Tienda en L√≠nea - Microservicios</title>
    <style>
      body {
        font-family: "Segoe UI", Roboto, sans-serif;
        background: linear-gradient(135deg, #f0f2f5, #d9e9ff);
        margin: 0;
        padding: 0;
        color: #333;
      }

      header {
        background-color: #0078d7;
        color: white;
        text-align: center;
        padding: 20px 0;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      h1 {
        margin: 0;
        font-size: 26px;
      }

      .botones {
        display: flex;
        justify-content: center;
        margin: 25px 0;
        flex-wrap: wrap;
        gap: 15px;
      }

      button {
        background-color: #0078d7;
        color: white;
        border: none;
        padding: 10px 18px;
        border-radius: 8px;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      button:hover {
        background-color: #005fa3;
        transform: translateY(-2px);
      }

      #tabla {
        width: 90%;
        max-width: 1000px;
        margin: 0 auto;
        background: white;
        border-radius: 10px;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        padding: 20px;
        animation: fadeIn 0.5s ease;
      }

      table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 10px;
      }

      th,
      td {
        padding: 10px 12px;
        text-align: center;
      }

      th {
        background-color: #0078d7;
        color: white;
      }

      tr:nth-child(even) {
        background-color: #f9f9f9;
      }

      tr:hover {
        background-color: #e9f3ff;
      }

      form {
        margin-top: 20px;
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 10px;
      }

      input {
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 6px;
        width: 180px;
      }

      form button {
        background-color: #28a745;
      }

      form button:hover {
        background-color: #218838;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body>
    <header>
      <h1>üõçÔ∏è Tienda en L√≠nea - Microservicios</h1>
    </header>

    <div class="botones">
      <button onclick="mostrarUsuarios()">Usuarios</button>
      <button onclick="mostrarProductos()">Productos</button>
      <button onclick="mostrarPedidos()">Pedidos</button>
    </div>

    <div id="tabla">
      <h2 style="text-align: center">Selecciona una categor√≠a para comenzar</h2>
    </div>

  <script>
  const API_USUARIOS = "http://3.145.23.235:5001/usuarios";
  const API_PRODUCTOS = "http://3.145.23.235:5002/productos";
  const API_PEDIDOS = "http://3.145.23.235:5003/pedidos";

  async function mostrarUsuarios() {
    const res = await fetch(API_USUARIOS);
    const data = await res.json();
    mostrarTabla(data, ["id", "nombre", "correo"], "Usuarios", "usuarios");
  }

  async function mostrarProductos() {
    const res = await fetch(API_PRODUCTOS);
    const data = await res.json();
    mostrarTabla(data, ["id", "nombre", "precio"], "Productos", "productos");
  }

  async function mostrarPedidos() {
    const res = await fetch(API_PEDIDOS);
    const data = await res.json();
    mostrarTabla(
      data,
      ["id", "usuario_id", "producto_id"],
      "Pedidos",
      "pedidos"
    );
  }

  function mostrarTabla(data, columnas, titulo, tipo) {
    let html = `<h2 style="text-align:center;">${titulo}</h2>`;
    html += "<table><tr>";
    columnas.forEach((col) => (html += `<th>${col.toUpperCase()}</th>`));
    html += "</tr>";

    data.forEach((item) => {
      html += "<tr>";
      columnas.forEach((col) => (html += `<td>${item[col]}</td>`));
      html += "</tr>";
    });
    html += "</table>";

    html += generarFormulario(tipo);
    document.getElementById("tabla").innerHTML = html;
  }

  function generarFormulario(tipo) {
    let campos = "";
    if (tipo === "usuarios") {
      campos = `
        <input id="nombre" placeholder="Nombre" />
        <input id="correo" placeholder="Correo" />
      `;
    } else if (tipo === "productos") {
      campos = `
        <input id="nombre" placeholder="Nombre del producto" />
        <input id="precio" placeholder="Precio" type="number" />
      `;
    } else if (tipo === "pedidos") {
      campos = `
        <input id="usuario_id" placeholder="ID Usuario" type="number" />
        <input id="producto_id" placeholder="ID Producto" type="number" />
      `;
    }

    return `
      <form onsubmit="agregarElemento(event, '${tipo}')">
        ${campos}
        <button type="submit">Agregar ${tipo.slice(0, -1)}</button>
      </form>
    `;
  }

  async function agregarElemento(event, tipo) {
    event.preventDefault();

    const datos = {};
    document.querySelectorAll("form input").forEach((input) => {
      datos[input.id] = input.value;
    });

    let url = "";
    if (tipo === "usuarios") url = API_USUARIOS;
    if (tipo === "productos") url = API_PRODUCTOS;
    if (tipo === "pedidos") url = API_PEDIDOS;

    await fetch(url, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(datos),
    });

    if (tipo === "usuarios") mostrarUsuarios();
    if (tipo === "productos") mostrarProductos();
    if (tipo === "pedidos") mostrarPedidos();
  }
</script>

  </body>
</html>
